# Email Corp - Анализ производительности Java Stream API

Проект для анализа производительности различных подходов к обработке данных в Java, с акцентом на Stream API и возможности параллельной обработки.

## Описание проекта

Проект симулирует корпоративную систему электронной почты, где сотрудники могут отправлять сообщения друг другу. Основная цель - анализ и сравнение различных методов сбора статистики об отправленных сообщениях.

## Условия лабораторных работ

### Лабораторная работа №1

1. Написать для согласованной предметной области как минимум 3 базовых класса и генераторы объектов. Генератор должен уметь создавать указанное количество различных объектов сответствующего класса со случайными (но при этом валидными) характеристиками. Класс, представляющий собой массовый объект должен обязательно содержать поля следющих типов:
   - один из примитивов (int, long, double)
   - String
   - дата/время (LocalDate, LocalTime, ...)
   - enum
   - record
   - массив или коллекция

   Остальные поля - произвольные, какие нужны для предметной области.
   Два оставшихся класса должны представлять собой дополнительные атрибуты и характиристики массового класса.

2. С помощью генератора создать коллекцию объектов.

3. Написать код, реализующий расчет согласованных агрегированных статических данных тремя способами:
   3.1. Итерационным циклом по коллекции
   3.2. Конвейером с помощью Stream API на базе коллекторов из стандартной библиотеки
   3.3. Конвейером с помощью собственного коллектора.

4. Для каждого варианта измерить время выполнения, зафиксировав моменты начала и окончания расчета для количества элементов в коллекции - 5000, 50000 и 250000. Время измерять с помощью методов класса System или Instant.

### Лабораторная работа №2

1. В один из методов, использовавшийся для сбора статистики, добавить возможность задать задержку, имитирующую задержку получения результата, например из базы данных. К примеру, был метод getName(), в который нужно добавить параметр getName(long delay)

2. Заменить последовательный стрим, собирающий статистику из лабораторной №1, на параллельный. Поменять итоговую коллекцию, где собирается результат, на соответствующую потокобезопасную. Измерить производительность для разного количества элементов с дополнительной задержкой и без задержки. Для случаев с задержкой и без найти количество элементов, при котором сбор статистики последовательным и параллельным стримами дают одинаковую скорость выполнения.

3. Оптимизировать параллельный сбор статистики, реализовав собственный ForkJoinPool или Spliterator. Измерить производительность своего варианта.

4. Измерения производительности выполнять с помощью фрейворка JMH.

## Структура проекта

- `src/main/java/org/itmolab/emailcorp/`
  - `EmailCorp.java` - основной класс приложения
  - `benchmarks/` - реализация JMH бенчмарков
  - `classes/` - основные классы предметной области (Company, Employee, Message)
  - `classes/generators/` - генераторы тестовых данных
  - `classes/collectors/` - реализация пользовательского коллектора
  - `classes/spliterators/` - реализация пользовательского сплитератора

## Запуск проекта

### Требования
- Java 17 или выше
- Maven

### Сборка
```bash
mvn clean package
```

### Запуск основного приложения
```bash
java -cp target/email-corp-1.0-SNAPSHOT.jar org.itmolab.emailcorp.EmailCorp
```

### Запуск JMH бенчмарков
```bash
java -cp target/email-corp-1.0-SNAPSHOT.jar org.itmolab.emailcorp.benchmarks.StatisticsBenchmark
```

## Тестовые данные

Бенчмарки запускаются с разными размерами данных:
- Малый: 5 000 сообщений
- Средний: 50 000 сообщений
- Большой: 250 000 сообщений

## Результаты

Результаты сохраняются в директории `results`, организованные по временным меткам. Каждый запуск создает:
- Детальную статистику для каждого метода
- Измерения времени выполнения
- Данные сравнения производительности